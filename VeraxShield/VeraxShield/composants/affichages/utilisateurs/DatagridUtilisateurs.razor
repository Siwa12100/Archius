@using VeraxShield.modele.utilisateurs;
@using Microsoft.AspNetCore.Components;
@using VeraxShield.composants.modals;

<DataGrid   TItem="Utilisateur"
            Data="@Utilisateurs"
            @bind-SelectedRow="@utilisateurSelectionne"
            Responsive
            ShowPager
            ShowPageSizes
            PagerPosition="DataGridPagerPosition.TopAndBottom"
            PagerOptions="new(){ ButtonSize=Size.Small }"
            OnUtilisateurSupprime="HandleUtilisateurSupprime">

    <DataGridColumns>

        <DataGridCommandColumn />

         <DataGridColumn Field="@nameof(Utilisateur.Pseudo)" Caption="Pseudo" Sortable="false" />
         <DataGridColumn Field="@nameof(Utilisateur.Prenom)" Caption="Prenom" Editable />
         <DataGridColumn Field="@nameof(Utilisateur.Nom)" Caption="Nom" Editable />
         <DataGridColumn Field="@nameof(Utilisateur.IsBan)" Caption="Banissement" Editable />

        <DataGridColumn Field="@nameof(Utilisateur.Pseudo)" Caption="Gerer">
        <DisplayTemplate>
            <button type="button" class="btn btn-primary" @onclick="() => onClickBoutonSuppression(context.Pseudo)"><i class="fa fa-trash"></i> Supprimer</button>
            <button type="button" class="btn btn-primary" @onclick="() => onClickBoutonModification(context.Pseudo)"><i class="fa fa-trash"></i> Modifier</button>
        </DisplayTemplate>
    </DataGridColumn>

    </DataGridColumns>

    <PageButtonTemplate>

        <Span TextColor="TextColor.Success">
            @context.PageNumber
        </Span>
    </PageButtonTemplate>

    <NextPageButtonTemplate><Icon Name="IconName.StepForward" TextColor="TextColor.Success" /></NextPageButtonTemplate>
    <PreviousPageButtonTemplate><Icon Name="IconName.StepBackward" TextColor="TextColor.Success" /></PreviousPageButtonTemplate>
    <LastPageButtonTemplate><Icon Name="IconName.Forward" TextColor="TextColor.Success" /></LastPageButtonTemplate>
    <FirstPageButtonTemplate><Icon Name="IconName.Backward" TextColor="TextColor.Success" /></FirstPageButtonTemplate>
    <TotalItemsTemplate><Badge Color="Color.Success">@context.TotalItems total items</Badge></TotalItemsTemplate>
    <TotalItemsShortTemplate><Badge Color="Color.Success">@context.TotalItems</Badge></TotalItemsShortTemplate>

        <ItemsPerPageTemplate></ItemsPerPageTemplate>

        <PageSelectorTemplate>

            <Select TextColor="TextColor.Success" @bind-SelectedValue="@context.CurrentPage" Size="Size.Small">
                @for (int i = context.FirstVisiblePage; i <= context.LastVisiblePage; ++i)
                {
                    var pageNumber = i;
                    <SelectItem Value="@pageNumber">@pageNumber</SelectItem>
                }
            </Select>
        </PageSelectorTemplate>

        <PageSizesTemplate>
            <Select TextColor="TextColor.Success" @bind-SelectedValue="@context.CurrentPageSize" Size="Size.Small">
            @foreach (var curPageSize in context.PageSizes)
            {
                <SelectItem Value="@curPageSize">@curPageSize</SelectItem>
            }
            </Select>
    </PageSizesTemplate>
</DataGrid>

<div>
    <NavLink class="btn btn-primary" href="/utilisateurs/ajouter" Match="NavLinkMatch.All">
        <i class="fa fa-plus"></i> Ajouter
    </NavLink>
</div>

<div>
    <ModalSuppressionUtilisateur
        utilisateur="@utilisateurSelectionne"
        @ref="Modal"
        modalFerme="fermetureModal" />
</div>

